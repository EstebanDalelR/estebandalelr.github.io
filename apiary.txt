FORMAT: 1A
HOST: https://car-b.app/

# Car B

This is the Car B carsharing API.   
Currently on version 1.

# Group Users

## Create a new user [/api/newuser]

### Post New user [POST]

Creates a new user and sends a JWT to be saved to uniquely identify the user. 
The password will be hashed upon arrival.
Cedula is the user id.
Coupon is optional.
Gender comes as 'Masculino', 'Femenino' , 'Otro' (since the app is in spanish)

+ Request (application/json)

        {
           "Cedula":123323542
           "Email":"test@mail.com",
           "Name":"Test",
           "LastName":"Tester",
           "Phone":"3203055035",
           "Birthdate":"2018-12-31",
           "City":"Bogotá",
           "Coupon":"CarBAPI",
           "Address":"Av calle 137b bis #31 - 4",
           "Password":"Rea||y$3cure",
           "Gender": "Masculino" 
        }
    
+ Response 200 (application/json)

        {
            "auth": "true",
            "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyUmVjb3JkIjp7IkNlZHVsYSI6MjM2NCwiRW1haWwiOiJlc3RlYmFuQGNhci1iLmNvIiwiTGFzdE5hbWUiOiJEYWxlbCIsIk5hbWUiOiJFc3RlYmFuIiwiUGhvbmUiOiIzMTU0MzQ1IiwiQmlydGhkYXRlIjoiMTk5NC0wNy0yOCIsIkNpdHkiOiJCb2ciLCJDb3Vwb24iOiJkc2QiLCJBZGRyZXNzIjoiQ2FsbGUxMjMiLCJUZXJtcyI6InRydWUiLCJIYXNoZWRQYXNzd29yZCI6IiQyYSQwOCRuZk14ZUQ4aXdSMGhtM1Nxa3h1NzcuUk1qd2FUUi5hUnVMLmV6NmFkV3dpSVBhazhtdnk4ZSIsIlN1YnNjcmlwdGlvbk11bHRpcGxpZXIiOltdfSwicmVjb3JkSUQiOiJyZWNnTjQ0TGU5TUllSkdvZCIsImlhdCI6MTUzNDE4MzEwNn0.6ma1Z0Wqd1-9D7gFW8muCQ_lbUXz1mJafTING_ngJEA"
        }
        
+ Response 401 (application/json)

        {
            "error": "Password missing"
        }
        
+ Response 401 (application/json)

        {
            "error": "Name missing"
        }
        
+ Response 401 (application/json)

        {
            "error": "LastName missing"
        }
        
+ Response 401 (application/json)

        {
            "error": "Address missing"
        }
        
+ Response 401 (application/json)

        {
            "error": "Email missing"
        }
+ Response 401 (application/json)

        {
            "error": "Phone missing"
        }
        
+ Response 401 (application/json)

        {
            "error": "Birthdate missing"
        }
        
## Login user [/api/login]

### Post user login [POST]

Checks the user login info and sends a JWT to be saved to uniquely identify the user. 
The password will be hashed upon arrival.
Cedula is the user id.  

+ Request (application/json)

        {
           "Email":"test@tester.co",
           "Password":"Rea||y$3cure",
        }

+ Response 200 (application/json)

        {
            "auth": "true",
            "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbWFpbCI6InRlc3RAbWFpbC5jb20iLCJOYW1lIjoiVGVzdCIsIkxhc3ROYW1lIjoiVGVzdGVyIiwiUGhvbmUiOiIzMjAzMDU1MDM1IiwiQmlydGhkYXRlIjoiMjAxOC0xMi0zMSIsIkNpdHkiOiJCb2dvdMOhIiwiQ291cG9uIjoiQ2FyQkFQSSIsIkFkZHJlc3MiOiJBdiBjYWxsZSAxMzdiIGJpcyAjMzEgLSA0IiwiVGVybXMiOiJ0cnVlIiwiUGFzc3dvcmQiOiJSZWF8fHkkM2N1cmUifQ.DM_3rUN8Xee3Te6tRtTBvpejwh851DCaT7Fh_xMtGG8"
        }
        
+ Response 401 (application/json)

        {
            "message": "Passwords don't match"
        }
        
## Update user field [/api/updateuser]

### Post new user data [POST]

Takes the field and value to update, returns the new user token.

+ Request (application/json)

        {
           "Field":"Email",
           "Value":"newTester@othermail.com",
        }

+ Response 200 (application/json)

        {
            "auth": "true",
            "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbWFpbCI6InRlc3RAbWFpbC5jb20iLCJOYW1lIjoiVGVzdCIsIkxhc3ROYW1lIjoiVGVzdGVyIiwiUGhvbmUiOiIzMjAzMDU1MDM1IiwiQmlydGhkYXRlIjoiMjAxOC0xMi0zMSIsIkNpdHkiOiJCb2dvdMOhIiwiQ291cG9uIjoiQ2FyQkFQSSIsIkFkZHJlc3MiOiJBdiBjYWxsZSAxMzdiIGJpcyAjMzEgLSA0IiwiVGVybXMiOiJ0cnVlIiwiUGFzc3dvcmQiOiJSZWF8fHkkM2N1cmUifQ.DM_3rUN8Xee3Te6tRtTBvpejwh851DCaT7Fh_xMtGG8"
        }
        
 
# Group Locations

## Get the locations [/api/locations]

### Get locations [GET]

Gets all the locations. Requires no auth. 
Some parkings may not currently have available cars.

+ Response 200 (application/json)

        [
            {
                "Name": "Éxito - 170",
                "Lat": 4.754439,
                "Long": -74.044269,
                "CarsAvailable": [
                    "reckbzjiP6TnCOl62"
                ],
                "Logo": "exito",
                "MondayOpen": "08:00",
                "MondayClose": "21:00",
                "TuesdayOpen": "08:00",
                "TuesdayClose": "21:00",
                "WednesdayOpen": "08:00",
                "WednesdayClose": "21:00",
                "ThursdayOpen": "08:00",
                "ThursdayClose": "21:00",
                "FridayOpen": "08:00",
                "FridayClose": "21:00",
                "SaturdayOpen": "08:00",
                "SaturdayClose": "21:00",
                "SundayOpen": "08:00",
                "SundayClose": "21:00",
                "HolidayOpen": "08:00",
                "HolidayClose": "21:00"
            },
            {
                "Name": "Éxito - Colina",
                "Lat": 4.734528,
                "Long": -74.06544,
                "CarsAvailable": [
                    "recgpeIXG1XeLJuPp"
                ],
                "Logo": "exito",
                "MondayOpen": "08:00",
                "MondayClose": "21:30",
                "TuesdayOpen": "08:00",
                "TuesdayClose": "21:30",
                "WednesdayOpen": "08:00",
                "WednesdayClose": "21:30",
                "ThursdayOpen": "08:00",
                "ThursdayClose": "21:30",
                "FridayOpen": "08:00",
                "FridayClose": "21:30",
                "SaturdayOpen": "08:00",
                "SaturdayClose": "21:30",
                "SundayOpen": "08:00",
                "SundayClose": "21:00",
                "HolidayOpen": "08:00",
                "HolidayClose": "21:00"
            },
            {
                "Name": "Éxito - 80",
                "Lat": 4.683743,
                "Long": -74.080677,
                "CarsAvailable": [
                    "recKe8qageVh5Emow"
                ],
                "Logo": "exito",
                "MondayOpen": "08:00",
                "MondayClose": "21:00",
                "TuesdayOpen": "08:00",
                "TuesdayClose": "21:00",
                "WednesdayOpen": "08:00",
                "WednesdayClose": "21:00",
                "ThursdayOpen": "08:00",
                "ThursdayClose": "21:00",
                "FridayOpen": "08:00",
                "FridayClose": "21:00",
                "SaturdayOpen": "08:00",
                "SaturdayClose": "21:00",
                "SundayOpen": "08:00",
                "SundayClose": "21:00",
                "HolidayOpen": "08:00",
                "HolidayClose": "21:00"
            },
            {
                "Name": "Éxito - Chapinero 53",
                "Lat": 4.639815,
                "Long": -74.06572,
                "Logo": "exito",
                "MondayOpen": "07:30",
                "MondayClose": "21:30",
                "TuesdayOpen": "07:30",
                "TuesdayClose": "21:30",
                "WednesdayOpen": "07:30",
                "WednesdayClose": "21:30",
                "ThursdayOpen": "07:30",
                "ThursdayClose": "21:30",
                "FridayOpen": "07:30",
                "FridayClose": "21:30",
                "SaturdayOpen": "07:30",
                "SaturdayClose": "21:30",
                "SundayOpen": "08:00",
                "SundayClose": "21:00",
                "HolidayOpen": "08:00",
                "HolidayClose": "21:00"
            },
            {
                "Name": "Carulla - 140",
                "Lat": 4.719226,
                "Long": -74.035825,
                "CarsAvailable": [
                    "reczkfvwwgu1efKVm",
                    "recfUSswzY6RPuWTR"
                ],
                "Logo": "carulla",
                "MondayOpen": "00:00",
                "MondayClose": "23:59",
                "TuesdayOpen": "00:00",
                "TuesdayClose": "23:59",
                "WednesdayOpen": "00:00",
                "WednesdayClose": "23:59",
                "ThursdayOpen": "00:00",
                "ThursdayClose": "23:59",
                "FridayOpen": "00:00",
                "FridayClose": "23:59",
                "SaturdayOpen": "00:00",
                "SaturdayClose": "23:59",
                "SundayOpen": "00:00",
                "SundayClose": "23:59",
                "HolidayOpen": "00:00",
                "HolidayClose": "23:59",
                "TotalAvailableSpots": 2
            },
            {
                "Name": "Carulla - Pepe Sierra 116",
                "Lat": 4.69576,
                "Long": -74.04367,
                "CarsAvailable": [
                    "recSDtC8gHVF6qy9D"
                ],
                "Logo": "carulla",
                "MondayOpen": "06:00",
                "MondayClose": "22:00",
                "TuesdayOpen": "06:00",
                "TuesdayClose": "22:00",
                "WednesdayOpen": "06:00",
                "WednesdayClose": "22:00",
                "ThursdayOpen": "06:00",
                "ThursdayClose": "22:00",
                "FridayOpen": "06:00",
                "FridayClose": "22:00",
                "SaturdayOpen": "06:00",
                "SaturdayClose": "22:00",
                "SundayOpen": "06:00",
                "SundayClose": "22:00",
                "HolidayOpen": "06:00",
                "HolidayClose": "22:00"
            },
            {
                "Name": "Carulla - 102",
                "Lat": 4.687433,
                "Long": -74.051218,
                "CarsAvailable": [
                    "reci4xxAfTsvzISYn",
                    "recXyPcL5z6NLQ2LY",
                    "recFzQsnusv00TRIE"
                ],
                "Logo": "carulla",
                "MondayOpen": "07:00",
                "MondayClose": "22:00",
                "TuesdayOpen": "07:00",
                "TuesdayClose": "22:00",
                "WednesdayOpen": "07:00",
                "WednesdayClose": "22:00",
                "ThursdayOpen": "07:00",
                "ThursdayClose": "22:00",
                "FridayOpen": "07:00",
                "FridayClose": "23:00",
                "SaturdayOpen": "07:00",
                "SaturdayClose": "23:00",
                "SundayOpen": "07:00",
                "SundayClose": "21:00",
                "HolidayOpen": "07:00",
                "HolidayClose": "21:00",
                "ReservesStarted": [
                    "reckZBiJ4t1T85OTD"
                ],
                "TotalAvailableSpots": 3
            },
            {
                "Name": "Central Parking - Gran Vatel",
                "Lat": 4.652464,
                "Long": -74.05485,
                "CarsAvailable": [
                    "recsj6PF6VDhpVpho"
                ],
                "Logo": "parking",
                "MondayOpen": "06:00",
                "MondayClose": "23:59",
                "TuesdayOpen": "06:00",
                "TuesdayClose": "23:59",
                "WednesdayOpen": "06:00",
                "WednesdayClose": "23:59",
                "ThursdayOpen": "06:00",
                "ThursdayClose": "23:59",
                "FridayOpen": "06:00",
                "FridayClose": "23:59",
                "SaturdayOpen": "06:00",
                "SaturdayClose": "23:59",
                "SundayOpen": "09:00",
                "SundayClose": "23:00",
                "HolidayOpen": "09:00",
                "HolidayClose": "23:00",
                "TotalAvailableSpots": 1
            },
        ]
        
## Car by record [/api/carrecord/{parkingrecord}]

+ Parameters 

    + parkingrecord (string) - The parking record to find

### Get car from a record [GET]

This method completes the call to the parkings. 
This allows async calls to quickly show the parkings, while getting the cars. 
A record is in the form (rec+hash):  
recgpeIXG1XeLJuPp

+ Response 200 (application/json)

        {
            "Plate": "NCR 775",
            "Transmission": "Automatic",
            "Color": "Blanco",
            "FuelType": "Electric",
            "Locations": [
                "recaES0sEWKn8jJJ6"
            ],
            "Availability": "True",
            "Brand": "Mitsubishi",
            "Model": "iMiev",
            "Model Year": 2013,
            "Name": "E+ 775",
            "Car Template": "Car B EV+",
            "FlowType": "FreeFlow",
            "Seats": 5,
            "PricePerHour": [
                "23000"
            ],
            "PricePerKm": [
                "800"
            ],
        }
    
# Group Reserves

## Create new reserve [/api/createreserve]

### Post new reserve [POST]

Creates a reserve for the date selected.
The date format is YYYY-MM-DD
The time format is HH:MM

+ Request (application/json)

    + Headers
    
            x-access-token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbWFpbCI6InRlc3RAbWFpbC5jb20iLCJOYW1lIjoiVGVzdCIsIkxhc3ROYW1lIjoiVGVzdGVyIiwiUGhvbmUiOiIzMjAzMDU1MDM1IiwiQmlydGhkYXRlIjoiMjAxOC0xMi0zMSIsIkNpdHkiOiJCb2dvdMOhIiwiQ291cG9uIjoiQ2FyQkFQSSIsIkFkZHJlc3MiOiJBdiBjYWxsZSAxMzdiIGJpcyAjMzEgLSA0IiwiVGVybXMiOiJ0cnVlIiwiUGFzc3dvcmQiOiJSZWF8fHkkM2N1cmUifQ.DM_3rUN8Xee3Te6tRtTBvpejwh851DCaT7Fh_xMtGG8"
    
    + Body
    
            {
                "CarPlate":"EJU 024",
                "StartDate":"2018-12-31",
                "StartTime":" 23:59"
                "EndDate":"2018-12-31",
                "EndTime":"23:59"
            }

+ Response 200 (application/json)

        [
            "rec4L3N6uPNOL17FN",
            {
                "ID": 145,
                "User": [
                    "recJKusCKxM60kDzQ"
                ],
                "UserEmail": [
                    "estebandalelr@gmail.com"
                ],
                "UserCedula": [
                    "1020795774"
                ],
                "UserEpaycoToken": [
                    "JzZiL3AqD3fCHZgEE"
                ],
                "TimeChargeType": [
                    "None"
                ],
                "TotalTimePrice": 0,
                "totalFreeMinutes": [],
                "Car": [
            "recKIkXDukemwlWzB"
                ],
                "PricePerKm": 800,
                "PricePerHour": 267,
                "TotalPrice": {
                    "error": "#ERROR!"
                },
                "CarPlate": [
                    "EJU 026"
                ],
                "CarModel": [
                    "Leon"
                ],
                "ReservedTimeCost": 22.25,
                "PricePerMinuteFrequent": [
                    "267"
                ],
                "PricePerMinuteOccasional": [
                    "317"
                ],
                "ReserveStartDate": "2018-08-31T18:10:00.000Z",
                "ReservedTime": 5,
                "ReserveEndDate": "2018-08-31T18:15:00.000Z",
                "AditionalTime": {
                    "specialValue": "NaN"
                },
                "TotalKms": 0,
                "TotalMinutes": {
                    "error": "#ERROR!"
                },
                "UniqueRecord": "rec4L3N6uPNOL17FN"
            }
        ]
        
## Start a reserve [/api/startreserve]

### Post new reserve [POST]

Starts a reserve for that user.

+ Request (application/json)

    + Headers
    
            x-access-token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbWFpbCI6InRlc3RAbWFpbC5jb20iLCJOYW1lIjoiVGVzdCIsIkxhc3ROYW1lIjoiVGVzdGVyIiwiUGhvbmUiOiIzMjAzMDU1MDM1IiwiQmlydGhkYXRlIjoiMjAxOC0xMi0zMSIsIkNpdHkiOiJCb2dvdMOhIiwiQ291cG9uIjoiQ2FyQkFQSSIsIkFkZHJlc3MiOiJBdiBjYWxsZSAxMzdiIGJpcyAjMzEgLSA0IiwiVGVybXMiOiJ0cnVlIiwiUGFzc3dvcmQiOiJSZWF8fHkkM2N1cmUifQ.DM_3rUN8Xee3Te6tRtTBvpejwh851DCaT7Fh_xMtGG8"
    
    + Body
    
            {
                "ReserveRecord": "recaES0sEWKn8jJJ6",
                "CarPlate":"EJU 024"
            }
    
+ Response 200 (application/json)

        {
          "ok":"true"
        }
        
## End a reserve [/api/endreserve]

### Post new reserve [POST]

Ends a reserve for a user.

+ Request (application/json)

    + Headers
    
            x-access-token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbWFpbCI6InRlc3RAbWFpbC5jb20iLCJOYW1lIjoiVGVzdCIsIkxhc3ROYW1lIjoiVGVzdGVyIiwiUGhvbmUiOiIzMjAzMDU1MDM1IiwiQmlydGhkYXRlIjoiMjAxOC0xMi0zMSIsIkNpdHkiOiJCb2dvdMOhIiwiQ291cG9uIjoiQ2FyQkFQSSIsIkFkZHJlc3MiOiJBdiBjYWxsZSAxMzdiIGJpcyAjMzEgLSA0IiwiVGVybXMiOiJ0cnVlIiwiUGFzc3dvcmQiOiJSZWF8fHkkM2N1cmUifQ.DM_3rUN8Xee3Te6tRtTBvpejwh851DCaT7Fh_xMtGG8"
    
    + Body
    
            {
                "ReserveRecord": "recaES0sEWKn8jJJ6",
                "CarPlate":"EJU 024"
            }
            
+ Response 200 (application/json)

        {
          "ok":"true"
        }
        
# Group Payments

## Create Payment token [/api/createpaymenttoken]

### Create Payment token [POST]

Creates a payment token. Requires a secure context.

+ Request (application/json)

    + Headers
    
            x-access-token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbWFpbCI6InRlc3RAbWFpbC5jb20iLCJOYW1lIjoiVGVzdCIsIkxhc3ROYW1lIjoiVGVzdGVyIiwiUGhvbmUiOiIzMjAzMDU1MDM1IiwiQmlydGhkYXRlIjoiMjAxOC0xMi0zMSIsIkNpdHkiOiJCb2dvdMOhIiwiQ291cG9uIjoiQ2FyQkFQSSIsIkFkZHJlc3MiOiJBdiBjYWxsZSAxMzdiIGJpcyAjMzEgLSA0IiwiVGVybXMiOiJ0cnVlIiwiUGFzc3dvcmQiOiJSZWF8fHkkM2N1cmUifQ.DM_3rUN8Xee3Te6tRtTBvpejwh851DCaT7Fh_xMtGG8"
    
    + Body
    
            {
              "Name":"Test Tester",
              "Number": "4561456145611236",
              "ExpiryYear":"24",
              "ExpiryYear":"12",
              "CVV":"123",
              "Issuer":"Visa",
              "LastFourDigits":"1236"
            }

+ Response 200 (application/json)

        {
          "Paymentoken":"pvSamkl:2dcAfs5df_a"
        }
        
# Group Promos

## Show Promos [/api/promos]

### Get all promos [GET]

Shows all curently active promos

+ Response 200 (application/json)

        {
            [
               {
                    "ID": 1,
                    "Title": "Todo incluído",
                    "Text": "Recuerda que con Car B todo va incluído. Si compras gasolina no olvides enviar tu factura a nuestra línea de soporte.",
                    "Icon": "stars"
                },
                {
                    "ID": 2,
                    "Title": "10 es 24",
                    "Text": "Por cada diez horas que pagues, te completamos las 24",
                    "Icon": "forward_10"
                },
                {
                    "ID": 3,
                    "Title": "Vamos de puente",
                    "Text": "Durante los puentes, el tercer día va por cuenta nuestra",
                    "Icon": "filter_3"
                }
            ]
        }
